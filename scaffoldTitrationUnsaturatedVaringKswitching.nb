(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68153,       1575]
NotebookOptionsPosition[     67561,       1550]
NotebookOutlinePosition[     67940,       1567]
CellTagsIndexPosition[     67897,       1564]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Scaffold protein titration motif: unsaturated", "Title",
 CellChangeTimes->{{3.6430002271357613`*^9, 3.6430002342704477`*^9}, {
  3.6461247813018913`*^9, 3.646124798059675*^9}, {3.646137656294923*^9, 
  3.646137661460257*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kd", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"des", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "7", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k11", "[", "t", "]"}], "*", "kd"}], "-", 
       RowBox[{"kd", "*", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "4", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "4", "]"}]}], "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "4", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "7", "]"}]}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "7", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", "0"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"init", "=", 
    RowBox[{"{", 
     RowBox[{
     "totK", ",", "totP", ",", "totS", ",", "0", ",", "0", ",", "0", ",", 
      "totT", ",", "0", ",", "0", ",", 
      RowBox[{"1.", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "4"}]}]}]}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tot", "[", "1", "]"}], ",", 
       RowBox[{"tot", "[", "2", "]"}], ",", 
       RowBox[{"tot", "[", "3", "]"}], ",", "0.00001", ",", "0.00001", ",", 
       "0.00001", ",", "totT", ",", "0.00001", ",", "0.00001"}], "}"}]}], 
    ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.645165414189527*^9, 3.645165427769722*^9}, {
  3.645166031633903*^9, 3.6451660515633183`*^9}, {3.6451750403475437`*^9, 
  3.645175042842551*^9}, {3.645261860064789*^9, 3.645261864629274*^9}, {
  3.645261941304412*^9, 3.645262008856084*^9}, {3.645264355979368*^9, 
  3.645264362719933*^9}, {3.645264936768906*^9, 3.6452649368701363`*^9}, {
  3.6454412224869432`*^9, 3.645441242215139*^9}, {3.645441927333969*^9, 
  3.64544193177353*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"us10pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.008242419051215819`", ",", "0.014297548563237405`", ",", 
       "0.38957563488014546`", ",", "0.009953109596179146`", ",", 
       "107.8661008438542`", ",", "0.006314953758460749`", ",", 
       "2.7579126947038177`", ",", "0.004425168723158293`", ",", 
       "124.86588613940748`", ",", "0.017694402307212805`", ",", 
       "0.0063478384949193474`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", 
       ",", "0.9543938503067778`", ",", "0.`", ",", "47503", ",", 
       "48.99935091067816`", ",", "10838.061688683034`", ",", 
       "0.0016045354632350055`", ",", "0.00014170725771695366`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "81.80999118688213`", ",", "779.9147566804214`", ",", 
       "0.07090238484877774`", ",", "0.023629370047937814`", ",", 
       "1.4828071618957515`", ",", "0.0018196786959553148`", ",", 
       "0.005166697684825859`", ",", "465.8452236367559`", ",", 
       "388.3893982720522`", ",", "25.739414637152606`", ",", 
       "4.514347828776098`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9504024006847739`", ",", "0.`", ",", "87739", ",", 
       "9.534112493466903`", ",", "62.829725785316626`", ",", 
       "90163.05037643343`", ",", "0.06627218650062923`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.007436884564263904`", ",", "0.011302916513155986`", ",", 
       "0.6710146976607011`", ",", "0.004928737708475768`", ",", 
       "566.8697056759694`", ",", "103.8344293843366`", ",", 
       "0.002438333353593688`", ",", "909.1470323607329`", ",", 
       "3.6740507654320447`", ",", "0.009326964883691391`", ",", 
       "2.145377995148467`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9503290174951521`", ",", "0.`", ",", "56261", ",", 
       "91.7477753322358`", ",", "136080.30589798294`", ",", 
       "372855.92268210783`", ",", "0.002538605337587`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.006988922196113958`", ",", "0.0016736661716845922`", ",", 
       "318.12838095689193`", ",", "0.0038768972135044114`", ",", 
       "75.93982400090636`", ",", "0.007134599728375874`", ",", 
       "0.0012982914730214718`", ",", "0.016636934080863704`", ",", 
       "12.661534720214746`", ",", "4.642433150565979`", ",", 
       "0.021257093058109425`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",",
        "0.9479971029049556`", ",", "0.`", ",", "23144", ",", 
       "45519.18674956106`", ",", "19589.62397457647`", ",", 
       "12.814483054521729`", ",", "0.3666564325060936`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "6.107425037429362`", ",", "649.5353552592625`", ",", 
       "0.7524260920765895`", ",", "0.0014729497141937231`", ",", 
       "8.052633347726365`", ",", "0.02845947181373509`", ",", 
       "0.015478298783216222`", ",", "1.5128329994165866`", ",", 
       "2.4676545739184803`", ",", "0.11102367043959017`", ",", 
       "0.006688833524495067`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",",
        "0.9479441576758459`", ",", "0.`", ",", "75112", ",", 
       "106.47495095986437`", ",", "5486.3331325357585`", ",", 
       "97.7389712270586`", ",", "0.044991576865351775`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.007091142109866954`", ",", "0.005493811788922619`", ",", 
       "0.5655818097924644`", ",", "0.005909143440224084`", ",", 
       "0.19845111705829294`", ",", "13.46397169306408`", ",", 
       "0.6441363015506287`", ",", "74.2184912184464`", ",", 
       "254.2504103533836`", ",", "0.3519518924650007`", ",", 
       "1.6715460955512464`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9479331300630189`", ",", "0.`", ",", "36286", ",", 
       "80.53365913888048`", ",", "2312.081767574129`", ",", 
       "115.22171788762766`", ",", "0.0013842726624347292`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.006952033584603749`", ",", "0.015604271163729836`", ",", 
       "154.2691402400409`", ",", "0.001395354228516014`", ",", 
       "1.3754389380406353`", ",", "0.0023541971467900594`", ",", 
       "0.9386755333546533`", ",", "81.45736642754734`", ",", 
       "1.1037849990246893`", ",", "0.024806469768168832`", ",", 
       "0.5496221885500605`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9476731015134761`", ",", "0.`", ",", "79621", ",", 
       "22192.750169229592`", ",", "987.4145984082729`", ",", 
       "86.77904508327147`", ",", "0.022474005164128855`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.007401960884046088`", ",", "0.04179474538192852`", ",", 
       "0.6798736666393617`", ",", "0.09099126158417799`", ",", 
       "264.62954656186565`", ",", "0.012876495300717751`", ",", 
       "0.3248988406197796`", ",", "54.70317785569333`", ",", 
       "0.00591257184529494`", ",", "94.04004332816972`", ",", 
       "0.7056955303863556`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9475847674835752`", ",", "0.`", ",", "85293", ",", 
       "97.49692322432392`", ",", "2908.4377823725404`", ",", 
       "168.36987707109427`", ",", "15905.099470884934`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.006969416194173042`", ",", "0.13071090665252838`", ",", 
       "16.18998053451299`", ",", "0.0011511100049083453`", ",", 
       "269.69306331568555`", ",", "0.04555911640342133`", ",", 
       "0.052740489526546266`", ",", "5.510645994323729`", ",", 
       "310.69539698143484`", ",", "0.03753319708675017`", ",", 
       "0.04930363704868246`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9474380184157137`", ",", "0.`", ",", "36673", ",", 
       "2341.758762349542`", ",", "234329.1442884873`", ",", 
       "104.4860607816318`", ",", "0.00012080384019655403`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.007074145703139318`", ",", "4.415959837084385`", ",", 
       "185.36101347734967`", ",", "0.0039031213188464313`", ",", 
       "0.003182560277136155`", ",", "0.060568034295841795`", ",", 
       "0.3217580470903207`", ",", "32.24322799746911`", ",", 
       "280.9757311687689`", ",", "0.11763574585579659`", ",", 
       "4.5847530834562225`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.9473864338646523`", ",", "0.`", ",", "97997", ",", 
       "26826.839773771706`", ",", "16.333234190071103`", ",", 
       "100.20954654917495`", ",", "0.00041866870624900456`"}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ad10pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.735571222241763`", ",", "118.64642205965505`", ",", 
       "582.9971400470964`", ",", "706.8394378169739`", ",", 
       "0.002422186552963498`", ",", "59.37025775545801`", ",", 
       "0.5878600457124783`", ",", "0.0012127352844165504`", ",", 
       "151.94773728590604`", ",", "0.16524734571475494`", ",", 
       "7.609634626396518`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.01843606088092748`", ",", "0.4943283032183251`", ",", "71037", ",", 
       "953.8757646994238`", ",", "0.08399740700006708`", ",", 
       "0.002062965995497673`", ",", "0.001087527518779857`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.9510092320017631`", ",", "121.83725928120194`", ",", 
       "177.41759263832117`", ",", "663.3635861616302`", ",", 
       "0.2955173181857165`", ",", "170.84963961593652`", ",", 
       "2.664287015821727`", ",", "0.004247279212263593`", ",", 
       "363.46711701346464`", ",", "0.11501887482620801`", ",", 
       "1.5820469188948103`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.013876464021015205`", ",", "0.45653676798203247`", ",", "55807", 
       ",", "153.38464165670985`", ",", "0.2579960077766799`", ",", 
       "0.0015941522767784968`", ",", "0.0003164491901531415`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
      "0.3606895529509488`", ",", "1.534103107697038`", ",", 
       "135.51328873200438`", ",", "428.19653077185984`", ",", 
       "0.003052211073389339`", ",", "0.11346843652385563`", ",", 
       "11.044705447359437`", ",", "0.003700851807618234`", ",", 
       "137.29122248645643`", ",", "0.009482758367214558`", ",", 
       "0.2127838614419442`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.005259805474808121`", ",", "0.4449755951280263`", ",", "22107", ",",
        "379.959415842407`", ",", "0.0002721195507754508`", ",", 
       "0.00033507926718888024`", ",", "0.00006907039063003476`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "3.3314111834820537`", ",", "0.01874688007545478`", ",", 
       "5.62503583285114`", ",", "203.72521708429753`", ",", 
       "0.17537882173838426`", ",", "479.2524500380064`", ",", 
       "3.976706503079339`", ",", "0.0017558092879061632`", ",", 
       "88.84226481994725`", ",", "0.0015373628546780326`", ",", 
       "0.11137016049474194`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.05708129990082774`", ",", "0.4439885965921797`", ",", "48557", ",", 
       "1.6941117148522045`", ",", "2.353306260861005`", ",", 
       "0.000441523478422801`", ",", "0.000017304408636967314`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.4263712958128932`", ",", "3.094221616489053`", ",", 
       "55.66855280989356`", ",", "227.29294234821705`", ",", 
       "0.0015908403954287436`", ",", "0.026636246655785505`", ",", 
       "179.4373522429962`", ",", "0.9639102346112335`", ",", 
       "0.7825520587634579`", ",", "0.015889462525724322`", ",", 
       "9.145624166899875`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.030283611858450087`", ",", "0.4343354873088408`", ",", "39037", ",",
        "137.82066242135073`", ",", "0.00012418813694606417`", ",", 
       "0.005371848294472684`", ",", "0.020304671552243955`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "17.093740671561175`", ",", "3.4110104554820273`", ",", 
       "0.30156520059711117`", ",", "72.28509472942149`", ",", 
       "2.8312131539517034`", ",", "4.312677838284476`", ",", 
       "261.8657186740548`", ",", "0.14454341959708286`", ",", 
       "6.412653361393108`", ",", "0.0022489030884043633`", ",", 
       "0.2537436236561277`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.01832132842854263`", ",", "0.4340831475771345`", ",", "15707", ",", 
       "0.217189187984801`", ",", "0.0988293785735121`", ",", 
       "0.0005519753419003141`", ",", "0.000350697747354272`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "259.8224990012565`", ",", "0.022446000141571533`", ",", 
       "56.558067727518896`", ",", "58.22453893726362`", ",", 
       "0.13401710647030238`", ",", "2.7412742760945514`", ",", 
       "367.65303670461117`", ",", "0.0028579974427508114`", ",", 
       "195.2944476702128`", ",", "0.023028381160966737`", ",", 
       "0.5059707885483982`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.11874911685269912`", ",", "0.41601545293856546`", ",", "98542", ",",
        "0.21776602852005836`", ",", "0.04938281066790332`", ",", 
       "7.773626646383596`*^-6", ",", "0.00011791621029520508`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0472267405408226`", ",", "0.0935083874368316`", ",", 
       "0.15388018935405978`", ",", "74.02173822499718`", ",", 
       "0.03166428360267055`", ",", "0.5597883119001384`", ",", 
       "10.572728095393058`", ",", "0.0011254266640571104`", ",", 
       "85.2735713860022`", ",", "0.0011377720978641365`", ",", 
       "1.0459271759021924`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.014894558619941321`", ",", "0.4149478777602289`", ",", "74671", ",",
        "5.238315707539667`", ",", "0.007990255426115827`", ",", 
       "0.0001064461938208268`", ",", "0.000013342611073645071`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "0.18074448632237966`", ",", "111.87094401000431`", ",", 
       "351.43867615111185`", ",", "406.63090789001194`", ",", 
       "0.14840084999571837`", ",", "476.6737337341944`", ",", 
       "3.7339281238515465`", ",", "0.003635315435596232`", ",", 
       "220.45933748214983`", ",", "0.011853700004796342`", ",", 
       "1.9493981488480692`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.008910858616333062`", ",", "0.4096603696865107`", ",", "47406", ",",
        "2563.340268840884`", ",", "1.1726165555353307`", ",", 
       "0.0009735900946712399`", ",", "0.000053768192085563686`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "116.35183658620625`", ",", "2.0148718617952834`", ",", 
       "12.9521322749468`", ",", "243.55229354986727`", ",", 
       "0.0011623264113556947`", ",", "14.400815211493702`", ",", 
       "450.64565227537145`", ",", "0.13848031079436982`", ",", 
       "41.29942858615112`", ",", "0.022905845947735887`", ",", 
       "0.33252083629741697`", ",", "0.0001`", ",", "0.1`", ",", "0.1`", ",", 
       "0.001239058727798742`", ",", "0.40801760540357`", ",", "3837", ",", 
       "0.12863573602169037`", ",", "0.0591329990286306`", ",", 
       "0.0003072931250865593`", ",", "0.0005546286409254794`"}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorf", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", "altitude", "]"}], ",", "Cyan"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", "altitude", "]"}], ",", "Magenta"}], "}"}]}], 
       "}"}], ",", "#"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", "n_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"col", "[", "#1", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", "#1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", ".5"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], "}"}], 
        "&"}], ",", 
       RowBox[{"Rescale", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"min", ",", "max"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", ".5"}]}], "]"}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"vars", "=", 
    RowBox[{"Array", "[", 
     RowBox[{"x", ",", "9"}], "]"}]}], ";", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"vars", ",", "k11"}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"dvars", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Derivative", "[", "1", "]"}], "[", "vars", "]"}], "]"}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"SeedRandom", "[", 
    RowBox[{"IntegerPart", "[", 
     RowBox[{"SessionTime", "[", "]"}], "]"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ts", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"totK", "=", "0.0001"}], ";", 
   RowBox[{"totP", "=", "0.1"}], ";", 
   RowBox[{"totS", "=", "0.1"}], ";", "\[IndentingNewLine]", 
   RowBox[{"stepNum", "=", "5"}], ";", "\[IndentingNewLine]", 
   RowBox[{"sampleSize", "=", "1000"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "iPar", ",", "num", ",", "usToAdPars", ",", "maxPars", 
       ",", "transPars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iPar", "=", "1"}], ",", 
        RowBox[{"iPar", "\[LessEqual]", "points"}], ",", 
        RowBox[{"iPar", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totT", "=", 
          RowBox[{
           RowBox[{"us10pars", "[", 
            RowBox[{"[", "iPar", "]"}], "]"}], "[", 
           RowBox[{"[", "11", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"usToAdPars", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"num", "=", "1"}], ",", 
           RowBox[{"num", "\[LessEqual]", "sampleSize"}], ",", 
           RowBox[{"num", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "ssthreshold", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"tot", "[", "n_", "]"}], ":=", 
                 RowBox[{
                  RowBox[{"tot", "[", "n", "]"}], "=", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"ksTest1", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"k", ",", "10"}], "]"}]}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", "1.*^-3"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", 
                 RowBox[{"1.", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "maxPars", "}"}], "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Array", "[", 
                   RowBox[{"k", ",", "10"}], "]"}], "\[Equal]", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "6"}], "-", "3"}], 
                    ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"us10pars", "[", 
                    RowBox[{"[", "iPar", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Range", "[", "4", "]"}], "+", "6"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "tPer", ",", "step", ",", "us", ",", "ad", ",", "x4", ",", 
                   "sol"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"step", "=", "0"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"tPer", "=", 
                   RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ssthreshold", "=", "1.*^-5"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"Print", "[", "des", "]"}], ";"}], " ", "*)"}], 
                  RowBox[{
                   RowBox[{"{", "sol", "}"}], "=", 
                   RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}], "\[Equal]", 
                    "des"}], ",", 
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"vars", "[", "0", "]"}], "]"}], "\[Equal]", 
                    "init"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"df", "=", 
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"WhenEvent", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", "df", "]"}], "<", "ssthreshold"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tPer", ",", "t"}], "]"}], ",", 
                    RowBox[{"step", "=", 
                    RowBox[{"step", "+", "1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step", ">", "stepNum"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"k11", "[", "t", "]"}], "\[Rule]", 
                    RowBox[{"10", "*", 
                    RowBox[{"k11", "[", "t", "]"}]}]}]}], "}"}]}], "]"}]}], 
                    "]"}]}], "}"}], "/.", "maxPars"}], ",", "vars", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "200000"}], "}"}], ",", 
                    RowBox[{"MaxSteps", "\[Rule]", "10000"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ts", "=", "tPer"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ts", "]"}], "==", 
                    RowBox[{"stepNum", "+", "1"}]}], " ", "&&", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"ts", ",", "Positive"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x4", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "/.", "sol"}], 
                    "]"}]}], ";", 
                    RowBox[{"xT", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "7", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "8", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "9", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}]}], ")"}], "/.", 
                    "sol"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    "totS"}], ")"}], "*", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"stepNum", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}]}], ")"}], "/", "2"}], ")"}], "/", 
                    "10.0"}], ",", "1.0"}], "]"}]}], ")"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "stepNum"}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ad", "=", 
                    RowBox[{"ad", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}], "/.", "sol"}], "]"}], "-", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", "sol"}], 
                    "]"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.2", "*", "totS"}], ")"}]}], ")"}], ",", 
                    "1.0"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "0.01", ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "totS"}], 
                    "]"}], ",", "0.01"}], "]"}], ")"}]}], ")"}]}], ")"}], 
                    "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ad", "/", "0.0001"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", "stepNum", ")"}]}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"usToAdPars", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"totT", ",", "us", ",", "ad", ",", "num"}], "}"}],
                     ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "[", "1", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "5", "]"}], ",", 
                    RowBox[{"k", "[", "6", "]"}], ",", 
                    RowBox[{"k", "[", "7", "]"}], ",", 
                    RowBox[{"k", "[", "8", "]"}], ",", 
                    RowBox[{"k", "[", "9", "]"}], ",", 
                    RowBox[{"k", "[", "10", "]"}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "2", "]"}], "+", 
                    RowBox[{"k", "[", "3", "]"}]}], 
                    RowBox[{"k", "[", "1", "]"}]], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "5", "]"}], "+", 
                    RowBox[{"k", "[", "6", "]"}]}], 
                    RowBox[{"k", "[", "4", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "8", "]"}], 
                    RowBox[{"k", "[", "7", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "10", "]"}], 
                    RowBox[{"k", "[", "9", "]"}]]}], "}"}], "/.", 
                    "maxPars"}]}], "]"}]}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transUsToAdPars", "=", 
          RowBox[{"Transpose", "[", "usToAdPars", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"usVsAd", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"altitude", "=", " ", 
          RowBox[{"Log10", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "*", 
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "16", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vsPlot", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"colorf", "[", "#1", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                   RowBox[{"Point", "[", "#2", "]"}]}], "}"}]}], "}"}], "&"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"altitude", ",", "usVsAd"}], "}"}]}], "]"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "None"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"24", ",", 
               RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"leg", "=", 
          RowBox[{"plotLegend", "[", 
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", ",", "Max"}], "}"}], "[", "altitude", "]"}], 
             "]"}], ",", "10", ",", "colorf"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"legTxt", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)\[Sqrt](\!\(\*SubscriptBox[\(K\), \
\(M1\)]\)\[Times]\!\(\*SubscriptBox[\(K\), \(M2\)]\))\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}]}], "]"}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pLeg", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"vsPlot", ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "600"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"legTxt", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "50"}], "}"}]}]}], "]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"leg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<unsaturatedUsToAdSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.pdf\>\""}], 
           ",", "pLeg"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<unsaturatedUsToAdSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.eps\>\""}], 
           ",", "pLeg"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", "vsPlot", "]"}], "*)"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "iPar", ",", "num", ",", "adToUsPars", ",", "maxPars", 
       ",", "transPars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", "10"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iPar", "=", "1"}], ",", 
        RowBox[{"iPar", "\[LessEqual]", "points"}], ",", 
        RowBox[{"iPar", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totT", "=", 
          RowBox[{
           RowBox[{"ad10pars", "[", 
            RowBox[{"[", "iPar", "]"}], "]"}], "[", 
           RowBox[{"[", "11", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"adToUsPars", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"num", "=", "1"}], ",", 
           RowBox[{"num", "\[LessEqual]", "sampleSize"}], ",", 
           RowBox[{"num", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "ssthreshold", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"tot", "[", "n_", "]"}], ":=", 
                 RowBox[{
                  RowBox[{"tot", "[", "n", "]"}], "=", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"ksTest1", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"k", ",", "10"}], "]"}]}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", "1.*^-3"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", 
                 RowBox[{"1.", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "maxPars", "}"}], "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Array", "[", 
                   RowBox[{"k", ",", "10"}], "]"}], "\[Equal]", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "6"}], "-", "3"}], 
                    ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ad10pars", "[", 
                    RowBox[{"[", "iPar", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Range", "[", "4", "]"}], "+", "6"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "tPer", ",", "step", ",", "us", ",", "ad", ",", "x4", ",", 
                   "sol"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"step", "=", "0"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"tPer", "=", 
                   RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ssthreshold", "=", "1.*^-5"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"Print", "[", "des", "]"}], ";"}], " ", "*)"}], 
                  RowBox[{
                   RowBox[{"{", "sol", "}"}], "=", 
                   RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}], "\[Equal]", 
                    "des"}], ",", 
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"vars", "[", "0", "]"}], "]"}], "\[Equal]", 
                    "init"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"df", "=", 
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"WhenEvent", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", "df", "]"}], "<", "ssthreshold"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tPer", ",", "t"}], "]"}], ",", 
                    RowBox[{"step", "=", 
                    RowBox[{"step", "+", "1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step", ">", "stepNum"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"k11", "[", "t", "]"}], "\[Rule]", 
                    RowBox[{"10", "*", 
                    RowBox[{"k11", "[", "t", "]"}]}]}]}], "}"}]}], "]"}]}], 
                    "]"}]}], "}"}], "/.", "maxPars"}], ",", "vars", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "200000"}], "}"}], ",", 
                    RowBox[{"MaxSteps", "\[Rule]", "10000"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ts", "=", "tPer"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ts", "]"}], "==", 
                    RowBox[{"stepNum", "+", "1"}]}], " ", "&&", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"ts", ",", "Positive"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x4", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "/.", "sol"}], 
                    "]"}]}], ";", 
                    RowBox[{"xT", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "7", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "8", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "9", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}]}], ")"}], "/.", 
                    "sol"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    "totS"}], ")"}], "*", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"stepNum", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}]}], ")"}], "/", "2"}], ")"}], "/", 
                    "10.0"}], ",", "1.0"}], "]"}]}], ")"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "stepNum"}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ad", "=", 
                    RowBox[{"ad", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}], "/.", "sol"}], "]"}], "-", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", "sol"}], 
                    "]"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.2", "*", "totS"}], ")"}]}], ")"}], ",", 
                    "1.0"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "0.01", ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "totS"}], 
                    "]"}], ",", "0.01"}], "]"}], ")"}]}], ")"}]}], ")"}], 
                    "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ad", "/", "0.0001"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", "stepNum", ")"}]}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"adToUsPars", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"totT", ",", "us", ",", "ad", ",", "num"}], "}"}],
                     ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "[", "1", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "5", "]"}], ",", 
                    RowBox[{"k", "[", "6", "]"}], ",", 
                    RowBox[{"k", "[", "7", "]"}], ",", 
                    RowBox[{"k", "[", "8", "]"}], ",", 
                    RowBox[{"k", "[", "9", "]"}], ",", 
                    RowBox[{"k", "[", "10", "]"}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "2", "]"}], "+", 
                    RowBox[{"k", "[", "3", "]"}]}], 
                    RowBox[{"k", "[", "1", "]"}]], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "5", "]"}], "+", 
                    RowBox[{"k", "[", "6", "]"}]}], 
                    RowBox[{"k", "[", "4", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "8", "]"}], 
                    RowBox[{"k", "[", "7", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "10", "]"}], 
                    RowBox[{"k", "[", "9", "]"}]]}], "}"}], "/.", 
                    "maxPars"}]}], "]"}]}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transAdToUsPars", "=", 
          RowBox[{"Transpose", "[", "adToUsPars", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"usVsAd", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"altitude", "=", " ", 
          RowBox[{"Log10", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "*", 
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "16", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vsPlot", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"colorf", "[", "#1", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                   RowBox[{"Point", "[", "#2", "]"}]}], "}"}]}], "}"}], "&"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"altitude", ",", "usVsAd"}], "}"}]}], "]"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "None"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"24", ",", 
               RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"leg", "=", 
          RowBox[{"plotLegend", "[", 
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", ",", "Max"}], "}"}], "[", "altitude", "]"}], 
             "]"}], ",", "10", ",", "colorf"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"legTxt", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)\[Sqrt](\!\(\*SubscriptBox[\(K\), \
\(M1\)]\)\[Times]\!\(\*SubscriptBox[\(K\), \(M2\)]\))\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}]}], "]"}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pLeg", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"vsPlot", ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "600"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"legTxt", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "50"}], "}"}]}]}], "]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"leg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<unsaturatedAdToUsSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.pdf\>\""}], 
           ",", "pLeg"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<unsaturatedAdToUsSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.eps\>\""}], 
           ",", "pLeg"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", "vsPlot", "]"}], "*)"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.646137755326373*^9, 3.646137784782524*^9}, {
  3.646137866975721*^9, 3.646137870662816*^9}, {3.646137941535911*^9, 
  3.646137961616476*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4132.010113`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.646137841530644*^9, 3.646137924231896*^9, 
  3.646142152185313*^9}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"NewKernel",
WindowSize->{1242, 760},
WindowMargins->{{9, Automatic}, {1015, Automatic}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 232, 3, 92, "Title"],
Cell[815, 27, 7556, 210, 250, "Input"],
Cell[8374, 239, 6491, 115, 556, "Input"],
Cell[14868, 356, 6711, 119, 618, "Input"],
Cell[21582, 477, 2406, 70, 91, "Input"],
Cell[CellGroupData[{
Cell[24013, 551, 43341, 989, 2635, "Input"],
Cell[67357, 1542, 176, 4, 39, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
