(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32191,       1050]
NotebookOptionsPosition[     30893,       1002]
NotebookOutlinePosition[     31248,       1018]
CellTagsIndexPosition[     31205,       1015]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Scaffold protein titration motif", "Title",
 CellChangeTimes->{{3.6430002271357613`*^9, 3.6430002342704477`*^9}}],

Cell[CellGroupData[{

Cell["The model description", "Section",
 CellChangeTimes->{{3.643000294588601*^9, 3.643000299851523*^9}}],

Cell[TextData[{
 "This particular motif describe one phosphorylation-desphosphorylation cycle \
(can be generalized to any futile cycles) with both kinase ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", "K"}], TraditionalForm]]],
 ") and phosphatase ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", "P"}], TraditionalForm]]],
 ") can be titrated by a scaffold protein ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", "T"}], TraditionalForm]]],
 ").\n\n",
 StyleBox["K + S \[Equilibrium] KS \[RightArrow] K + ", "DisplayFormula"],
 StyleBox[Cell[BoxData[
  FormBox[
   SubscriptBox["S", "p"], TraditionalForm]], "DisplayFormula"], 
  "DisplayFormula"],
 StyleBox["\nP + ", "DisplayFormula"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["S", "p"], " ", "\[Equilibrium]", " ", 
    SubscriptBox["PS", "p"]}], TraditionalForm]], "DisplayFormula"], 
  "DisplayFormula"],
 StyleBox[" \[RightArrow] P + S\nT + K \[Equilibrium] TK\nT + P \
\[Equilibrium] TP", "DisplayFormula"],
 "\n\nThe above reactions show a simple system that composed of one scaffold \
protein, one kinase, one phosphatase and one substrate. Here we try to \
descibe this simple system with differential equation following the mass \
action kinetics.\n\n",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "K", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "[", "K", "]"}], "[", "S", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "2"], "[", "KS", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "3"], "[", "KS", "]"}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "7"], "[", "T", "]"}], "[", "K", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "8"], "[", "TK", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "P", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "4"], "[", "P", "]"}], "[", 
         SubscriptBox["S", "p"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "5"], "[", 
        SubscriptBox["PS", "p"], "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "6"], "[", 
        SubscriptBox["PS", "p"], "]"}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "9"], "[", "T", "]"}], "[", "P", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "10"], "[", "TP", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "S", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "[", "K", "]"}], "[", "S", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "2"], "[", "KS", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "6"], "[", 
        SubscriptBox["PS", "p"], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", 
         SubscriptBox["S", "p"], "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "4"], "[", "P", "]"}], "[", 
         SubscriptBox["S", "p"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "3"], "[", "KS", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "5"], "[", 
        SubscriptBox["PS", "p"], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "KS", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "1"], "[", "K", "]"}], "[", "S", "]"}], "-", 
       RowBox[{
        SubscriptBox["k", "2"], "[", "KS", "]"}], "-", 
       RowBox[{
        SubscriptBox["k", "3"], "[", "KS", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", 
         SubscriptBox["PS", "p"], "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "4"], "[", "P", "]"}], "[", 
        SubscriptBox["S", "p"], "]"}], "-", 
       RowBox[{
        SubscriptBox["k", "5"], "[", 
        SubscriptBox["PS", "p"], "]"}], "-", 
       RowBox[{
        SubscriptBox["k", "6"], "[", 
        SubscriptBox["PS", "p"], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "T", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "7"], "[", "T", "]"}], "[", "K", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "8"], "[", "TK", "]"}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "9"], "[", "T", "]"}], "[", "P", "]"}], "+", 
       RowBox[{
        SubscriptBox["k", "10"], "[", "TP", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "TK", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "7"], "[", "T", "]"}], "[", "K", "]"}], "-", 
       RowBox[{
        SubscriptBox["k", "8"], "[", "TK", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"[", "TP", "]"}]}], 
       RowBox[{"\[DifferentialD]", "t"}]], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "9"], "[", "T", "]"}], "[", "P", "]"}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "10"], "[", "TP", "]"}], "."}]}]}]}], 
    "DisplayFormula"], TraditionalForm]]],
 "\n\nAnd the system need to follow these conservation equations:\n\n",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"[", "K", "]"}], "+", 
       RowBox[{"[", "KS", "]"}], "+", 
       RowBox[{"[", "TK", "]"}]}], "=", 
      RowBox[{"[", 
       SubscriptBox["K", "tot"], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"[", "P", "]"}], "+", 
       RowBox[{"[", 
        SubscriptBox["PS", "p"], "]"}], "+", 
       RowBox[{"[", "TP", "]"}]}], "=", 
      RowBox[{"[", 
       SubscriptBox["P", "tot"], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"[", "S", "]"}], "+", 
       RowBox[{"[", 
        SubscriptBox["S", "p"], "]"}], "+", 
       RowBox[{"[", "KS", "]"}], "+", 
       RowBox[{"[", 
        SubscriptBox["PS", "p"], "]"}]}], "=", 
      RowBox[{"[", 
       SubscriptBox["S", "tot"], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"[", "T", "]"}], "+", 
       RowBox[{"[", "TK", "]"}], "+", 
       RowBox[{"[", "TP", "]"}]}], "=", 
      RowBox[{
       RowBox[{"[", 
        SubscriptBox["T", "tot"], "]"}], "."}]}]}], "DisplayFormula"], 
   TraditionalForm]]],
 "\n\nIn the following setion, we will solve the differential equations to \
understand the dynamics and behaviour of such system."
}], "Text",
 CellChangeTimes->{{3.64300032946461*^9, 3.643000411949408*^9}, 
   3.643000765009842*^9, {3.643000801521837*^9, 3.643000819809833*^9}, {
   3.6430008671825657`*^9, 3.643000900906423*^9}, {3.6430009876621447`*^9, 
   3.643001018130637*^9}, {3.643001148803453*^9, 3.643001408094447*^9}, {
   3.643001469379396*^9, 3.64300206984488*^9}, {3.643002302021605*^9, 
   3.64300248368265*^9}, {3.6430028896311207`*^9, 3.643002995076975*^9}, {
   3.643008434602817*^9, 3.6430084533503437`*^9}, {3.643008493769312*^9, 
   3.64300854988597*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Understanding the dynamics of this simple system at steady states\
\>", "Section",
 CellChangeTimes->{{3.643008555381485*^9, 3.643008583516593*^9}, {
  3.6433655530615463`*^9, 3.643365557234893*^9}}],

Cell[TextData[StyleBox["The reactions are:", "DisplayFormula"]], "Text",
 CellChangeTimes->{{3.643361856288289*^9, 3.6433618645906973`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"K", "+", "S"}], "\[Equilibrium]", "KS"}], "\[RightArrow]", 
  RowBox[{"K", "+", 
   SubscriptBox["S", "p"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "+", 
    SubscriptBox["S", "p"]}], "\[Equilibrium]", 
   SubscriptBox["PS", "p"]}], "\[RightArrow]", 
  RowBox[{"P", "+", "S"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "+", "K"}], "\[Equilibrium]", "TK"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "+", "P"}], "\[Equilibrium]", "TP"}]}], "DisplayFormula",
 CellChangeTimes->{{3.6433618774715548`*^9, 3.6433619330526648`*^9}, {
  3.6433620036273327`*^9, 3.6433620088325567`*^9}, {3.643362129281958*^9, 
  3.6433622183967943`*^9}}],

Cell["The species are:", "Text",
 CellChangeTimes->{{3.643008589316565*^9, 3.643008598380373*^9}, {
  3.643008653866585*^9, 3.643008686730983*^9}, {3.643361831457127*^9, 
  3.6433618516152163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"K", 
    RowBox[{"(", "1", ")"}]}], ",", 
   RowBox[{"P", 
    RowBox[{"(", "2", ")"}]}], ",", 
   RowBox[{"S", 
    RowBox[{"(", "3", ")"}]}], ",", 
   RowBox[{
    SubscriptBox["S", "p"], 
    RowBox[{"(", "4", ")"}]}], ",", 
   RowBox[{"KS", 
    RowBox[{"(", "5", ")"}]}], ",", 
   RowBox[{
    SubscriptBox["PS", "p"], 
    RowBox[{"(", "6", ")"}]}], ",", 
   RowBox[{"T", 
    RowBox[{"(", "7", ")"}]}], ",", 
   RowBox[{"TK", 
    RowBox[{"(", "8", ")"}]}], ",", 
   RowBox[{"TP", 
    RowBox[{"(", "9", ")"}]}]}], "}"}]], "DisplayFormula",
 CellChangeTimes->{{3.643008711850252*^9, 3.64300877181549*^9}, {
  3.6433622575002604`*^9, 3.643362310785508*^9}}],

Cell["Here we have the differential equations:", "Text",
 CellChangeTimes->{{3.643008691634817*^9, 3.6430086930249767`*^9}, {
  3.643362288361381*^9, 3.643362297585257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "10", "}"}], ",", 
     RowBox[{"{", "9", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "5", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"A", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "[", 
    RowBox[{"[", "5", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "[", 
    RowBox[{"[", "6", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"A", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "[", 
    RowBox[{"[", "6", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "[", 
    RowBox[{"[", "7", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "[", 
    RowBox[{"[", "8", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "8", "]"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"A", "[", 
     RowBox[{"[", "7", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "[", 
    RowBox[{"[", "7", "]"}], "]"}], "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "[", 
    RowBox[{"[", "9", "]"}], "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "10", "]"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"A", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stoiM", "=", 
   RowBox[{"Transpose", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["k", "1"], 
      SubscriptBox["x", "1"], 
      SubscriptBox["x", "3"]}], ",", 
     RowBox[{
      SubscriptBox["k", "2"], 
      SubscriptBox["x", "5"]}], ",", 
     RowBox[{
      SubscriptBox["k", "3"], 
      SubscriptBox["x", "5"]}], ",", 
     RowBox[{
      SubscriptBox["k", "4"], 
      SubscriptBox["x", "2"], 
      SubscriptBox["x", "4"]}], ",", 
     RowBox[{
      SubscriptBox["k", "5"], 
      SubscriptBox["x", "6"]}], ",", 
     RowBox[{
      SubscriptBox["k", "6"], 
      SubscriptBox["x", "6"]}], ",", 
     RowBox[{
      SubscriptBox["k", "7"], 
      SubscriptBox["x", "1"], 
      SubscriptBox["x", "7"]}], ",", 
     RowBox[{
      SubscriptBox["k", "8"], 
      SubscriptBox["x", "8"]}], ",", 
     RowBox[{
      SubscriptBox["k", "9"], 
      SubscriptBox["x", "2"], 
      SubscriptBox["x", "7"]}], ",", 
     RowBox[{
      SubscriptBox["k", "10"], 
      SubscriptBox["x", "9"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqns", "=", 
  RowBox[{"stoiM", ".", "ks"}]}], "\[IndentingNewLine]", 
 RowBox[{"mC", "=", 
  RowBox[{"RowReduce", "[", 
   RowBox[{"NullSpace", "[", "A", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.643361674632876*^9, 3.64336167547089*^9}, {
   3.6433617147367992`*^9, 3.643361793985777*^9}, {3.643362243655946*^9, 
   3.643362247349186*^9}, {3.643362322283595*^9, 3.6433624330175447`*^9}, {
   3.643362579076962*^9, 3.643362783772904*^9}, {3.643364279187258*^9, 
   3.643364414971779*^9}, {3.643364485773497*^9, 3.643364582982481*^9}, 
   3.643365235208138*^9, {3.643366034988674*^9, 3.643366061592079*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "1"]}], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "3"]}], "+", 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["x", "5"]}], "+", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["x", "5"]}], "-", 
    RowBox[{
     SubscriptBox["k", "7"], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "7"]}], "+", 
    RowBox[{
     SubscriptBox["k", "8"], " ", 
     SubscriptBox["x", "8"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "4"]}], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "4"]}], "+", 
    RowBox[{
     SubscriptBox["k", "5"], " ", 
     SubscriptBox["x", "6"]}], "+", 
    RowBox[{
     SubscriptBox["k", "6"], " ", 
     SubscriptBox["x", "6"]}], "-", 
    RowBox[{
     SubscriptBox["k", "9"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "7"]}], "+", 
    RowBox[{
     SubscriptBox["k", "10"], " ", 
     SubscriptBox["x", "9"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "1"]}], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "3"]}], "+", 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["x", "5"]}], "+", 
    RowBox[{
     SubscriptBox["k", "6"], " ", 
     SubscriptBox["x", "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "4"]}], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "4"]}], "+", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["x", "5"]}], "+", 
    RowBox[{
     SubscriptBox["k", "5"], " ", 
     SubscriptBox["x", "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "3"]}], "-", 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["x", "5"]}], "-", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["x", "5"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "4"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "4"]}], "-", 
    RowBox[{
     SubscriptBox["k", "5"], " ", 
     SubscriptBox["x", "6"]}], "-", 
    RowBox[{
     SubscriptBox["k", "6"], " ", 
     SubscriptBox["x", "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "7"]}], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "7"]}], "-", 
    RowBox[{
     SubscriptBox["k", "9"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "7"]}], "+", 
    RowBox[{
     SubscriptBox["k", "8"], " ", 
     SubscriptBox["x", "8"]}], "+", 
    RowBox[{
     SubscriptBox["k", "10"], " ", 
     SubscriptBox["x", "9"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "7"], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "7"]}], "-", 
    RowBox[{
     SubscriptBox["k", "8"], " ", 
     SubscriptBox["x", "8"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "9"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "7"]}], "-", 
    RowBox[{
     SubscriptBox["k", "10"], " ", 
     SubscriptBox["x", "9"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.643364538086688*^9, 3.643364555293939*^9}, 
   3.643364585570484*^9, 3.643365238114052*^9, 3.643366070347221*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0",
      ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1",
      ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.643364538086688*^9, 3.643364555293939*^9}, 
   3.643364585570484*^9, 3.643365238114052*^9, 3.643366070353777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subsEqns", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"eqns", "[", 
     RowBox[{"[", "4", "]"}], "]"}], ",", 
    RowBox[{"eqns", "[", 
     RowBox[{"[", "5", "]"}], "]"}], ",", 
    RowBox[{"eqns", "[", 
     RowBox[{"[", "6", "]"}], "]"}], ",", 
    RowBox[{"eqns", "[", 
     RowBox[{"[", "8", "]"}], "]"}], ",", 
    RowBox[{"eqns", "[", 
     RowBox[{"[", "9", "]"}], "]"}], ",", 
    RowBox[{
     SubscriptBox["x", "1"], "+", 
     SubscriptBox["x", "5"], "+", 
     SubscriptBox["x", "8"], "-", 
     SubscriptBox["T", "1"]}], ",", 
    RowBox[{
     SubscriptBox["x", "2"], "+", 
     SubscriptBox["x", "6"], "+", 
     SubscriptBox["x", "9"], "-", 
     SubscriptBox["T", "2"]}], ",", 
    RowBox[{
     SubscriptBox["x", "3"], "+", 
     SubscriptBox["x", "4"], "+", 
     SubscriptBox["x", "5"], "+", 
     SubscriptBox["x", "6"], "-", 
     SubscriptBox["T", "3"]}], ",", 
    RowBox[{
     SubscriptBox["x", "7"], "+", 
     SubscriptBox["x", "8"], "+", 
     SubscriptBox["x", "9"], "-", 
     SubscriptBox["T", "4"]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.643364605281082*^9, 3.643364619344001*^9}, {
  3.643366139136932*^9, 3.643366283768693*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "4"]}], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "4"]}], "+", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["x", "5"]}], "+", 
    RowBox[{
     SubscriptBox["k", "5"], " ", 
     SubscriptBox["x", "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "1"], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "3"]}], "-", 
    RowBox[{
     SubscriptBox["k", "2"], " ", 
     SubscriptBox["x", "5"]}], "-", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SubscriptBox["x", "5"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "4"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "4"]}], "-", 
    RowBox[{
     SubscriptBox["k", "5"], " ", 
     SubscriptBox["x", "6"]}], "-", 
    RowBox[{
     SubscriptBox["k", "6"], " ", 
     SubscriptBox["x", "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "7"], " ", 
     SubscriptBox["x", "1"], " ", 
     SubscriptBox["x", "7"]}], "-", 
    RowBox[{
     SubscriptBox["k", "8"], " ", 
     SubscriptBox["x", "8"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "9"], " ", 
     SubscriptBox["x", "2"], " ", 
     SubscriptBox["x", "7"]}], "-", 
    RowBox[{
     SubscriptBox["k", "10"], " ", 
     SubscriptBox["x", "9"]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["T", "1"]}], "+", 
    SubscriptBox["x", "1"], "+", 
    SubscriptBox["x", "5"], "+", 
    SubscriptBox["x", "8"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["T", "2"]}], "+", 
    SubscriptBox["x", "2"], "+", 
    SubscriptBox["x", "6"], "+", 
    SubscriptBox["x", "9"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["T", "3"]}], "+", 
    SubscriptBox["x", "3"], "+", 
    SubscriptBox["x", "4"], "+", 
    SubscriptBox["x", "5"], "+", 
    SubscriptBox["x", "6"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["T", "4"]}], "+", 
    SubscriptBox["x", "7"], "+", 
    SubscriptBox["x", "8"], "+", 
    SubscriptBox["x", "9"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6433662924697533`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], "}"}], "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "4"], ",", 
      SubscriptBox["x", "5"], ",", 
      SubscriptBox["x", "6"], ",", 
      SubscriptBox["x", "8"], ",", 
      SubscriptBox["x", "9"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643366336179184*^9, 3.64336643459307*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "4"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["k", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["k", "5"], "+", 
         SubscriptBox["k", "6"]}], ")"}], " ", 
       SubscriptBox["x", "1"], " ", 
       SubscriptBox["x", "3"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["k", "2"], "+", 
         SubscriptBox["k", "3"]}], ")"}], " ", 
       SubscriptBox["k", "4"], " ", 
       SubscriptBox["k", "6"], " ", 
       SubscriptBox["x", "2"]}]]}], ",", 
    RowBox[{
     SubscriptBox["x", "5"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["x", "1"], " ", 
       SubscriptBox["x", "3"]}], 
      RowBox[{
       SubscriptBox["k", "2"], "+", 
       SubscriptBox["k", "3"]}]]}], ",", 
    RowBox[{
     SubscriptBox["x", "6"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["x", "1"], " ", 
       SubscriptBox["x", "3"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["k", "2"], "+", 
         SubscriptBox["k", "3"]}], ")"}], " ", 
       SubscriptBox["k", "6"]}]]}], ",", 
    RowBox[{
     SubscriptBox["x", "8"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "7"], " ", 
       SubscriptBox["x", "1"], " ", 
       SubscriptBox["x", "7"]}], 
      SubscriptBox["k", "8"]]}], ",", 
    RowBox[{
     SubscriptBox["x", "9"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["k", "9"], " ", 
       SubscriptBox["x", "2"], " ", 
       SubscriptBox["x", "7"]}], 
      SubscriptBox["k", "10"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6433664404378157`*^9}]
}, Open  ]],

Cell["\<\
The following is merely show that there is only one steady state for this \
system\
\>", "Text",
 CellChangeTimes->{{3.643366880798333*^9, 3.643366923549088*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacobian", "=", 
   RowBox[{"D", "[", 
    RowBox[{"subsEqns", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"], ",", 
        SubscriptBox["x", "3"], ",", 
        SubscriptBox["x", "4"], ",", 
        SubscriptBox["x", "5"], ",", 
        SubscriptBox["x", "6"], ",", 
        SubscriptBox["x", "7"], ",", 
        SubscriptBox["x", "8"], ",", 
        SubscriptBox["x", "9"]}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"detJ", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", 
      RowBox[{"Det", "[", "jacobian", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["x", "3"], ",", 
       SubscriptBox["x", "4"], ",", 
       SubscriptBox["x", "5"], ",", 
       SubscriptBox["x", "6"], ",", 
       SubscriptBox["x", "7"], ",", 
       SubscriptBox["x", "8"], ",", 
       SubscriptBox["x", "9"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"detSubs", "=", 
   RowBox[{"Replace", "[", 
    RowBox[{"detJ", ",", 
     RowBox[{"solution", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polSubs", "=", 
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", "detSubs", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalSubs", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", "polSubs", "]"}], ",", 
     SubscriptBox["x", "_"], ",", "FactorTerms"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.643366698131743*^9, 3.643366717351111*^9}, 
   3.643366835940318*^9, {3.6433669363122253`*^9, 3.64336695196773*^9}}],

Cell["\<\
Now try a different equation set to solve the system with parameter of [T]\
\>", "Text",
 CellChangeTimes->{{3.643367092552786*^9, 3.6433671229989233`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", 
       RowBox[{"subsEqns", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "}"}], "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"], ",", 
      SubscriptBox["x", "3"], ",", 
      SubscriptBox["x", "4"], ",", 
      SubscriptBox["x", "5"], ",", 
      SubscriptBox["x", "6"], ",", 
      SubscriptBox["x", "8"], ",", 
      SubscriptBox["x", "9"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643367193698986*^9, 3.643367242471057*^9}, {
  3.643367722240954*^9, 3.643367740787838*^9}, {3.643367772741246*^9, 
  3.643367798538733*^9}, {3.6433699547765703`*^9, 3.64336997182723*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6433677132156887`*^9, 3.643367762230076*^9, 
  3.643367933345249*^9, 3.643374323562859*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1202, 975},
WindowMargins->{{Automatic, 32}, {Automatic, 0}},
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 119, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[724, 27, 106, 1, 64, "Section"],
Cell[833, 30, 8050, 235, 811, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8920, 270, 209, 4, 64, "Section"],
Cell[9132, 276, 140, 1, 30, "Text"],
Cell[9275, 279, 720, 18, 81, "DisplayFormula"],
Cell[9998, 299, 198, 3, 30, "Text"],
Cell[10199, 304, 715, 24, 26, "DisplayFormula"],
Cell[10917, 330, 173, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[11115, 336, 5543, 186, 166, "Input"],
Cell[16661, 524, 3398, 120, 46, "Output"],
Cell[20062, 646, 749, 20, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20848, 671, 1198, 36, 31, "Input"],
Cell[22049, 709, 2188, 78, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24274, 792, 848, 24, 28, "Input"],
Cell[25125, 818, 1906, 64, 50, "Output"]
}, Open  ]],
Cell[27046, 885, 172, 4, 30, "Text"],
Cell[27221, 891, 1948, 58, 120, "Input"],
Cell[29172, 951, 166, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[29363, 958, 1339, 35, 48, "Input"],
Cell[30705, 995, 148, 2, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
