(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71564,       1645]
NotebookOptionsPosition[     70823,       1617]
NotebookOutlinePosition[     71178,       1633]
CellTagsIndexPosition[     71135,       1630]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Scaffold protein titration motif: saturated", "Title",
 CellChangeTimes->{{3.6430002271357613`*^9, 3.6430002342704477`*^9}, {
  3.6461247813018913`*^9, 3.646124798059675*^9}, {3.646137667550736*^9, 
  3.6461376693239307`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kd", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"des", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "7", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k11", "[", "t", "]"}], "*", "kd"}], "-", 
       RowBox[{"kd", "*", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "4", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "4", "]"}]}], "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "3", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "2", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "5", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "4", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "4", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "5", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "6", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "6", "]"}], "[", "t", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "7", "]"}]}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], "*", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "7", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "8", "]"}], "*", " ", 
        RowBox[{
         RowBox[{"x", "[", "8", "]"}], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "9", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "7", "]"}], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"k", "[", "10", "]"}], " ", "*", 
        RowBox[{
         RowBox[{"x", "[", "9", "]"}], "[", "t", "]"}]}]}], ",", "0"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"init", "=", 
    RowBox[{"{", 
     RowBox[{
     "totK", ",", "totP", ",", "totS", ",", "0", ",", "0", ",", "0", ",", 
      "totT", ",", "0", ",", "0", ",", 
      RowBox[{"1.", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "4"}]}]}]}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tot", "[", "1", "]"}], ",", 
       RowBox[{"tot", "[", "2", "]"}], ",", 
       RowBox[{"tot", "[", "3", "]"}], ",", "0.00001", ",", "0.00001", ",", 
       "0.00001", ",", "totT", ",", "0.00001", ",", "0.00001"}], "}"}]}], 
    ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.645165414189527*^9, 3.645165427769722*^9}, {
  3.645166031633903*^9, 3.6451660515633183`*^9}, {3.6451750403475437`*^9, 
  3.645175042842551*^9}, {3.645261860064789*^9, 3.645261864629274*^9}, {
  3.645261941304412*^9, 3.645262008856084*^9}, {3.645264355979368*^9, 
  3.645264362719933*^9}, {3.645264936768906*^9, 3.6452649368701363`*^9}, {
  3.6454412224869432`*^9, 3.645441242215139*^9}, {3.645441927333969*^9, 
  3.64544193177353*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"us10pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.015205846796259167`", ",", "550.3944579159456`", ",", 
       "26.734683253024173`", ",", "0.02556525291577048`", ",", 
       "120.70562911952993`", ",", "0.5763814532369987`", ",", 
       "60.583390059512965`", ",", "41.039734153889725`", ",", 
       "746.6358353492825`", ",", "0.0036050445171060892`", ",", 
       "8.252769016992334`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9484241151288099`", ",", "0.056600313684937474`", ",", "40686", ",",
        "37954.42298622599`", ",", "4744.017630975655`", ",", 
       "0.6774090078745199`", ",", "4.828383994480548`*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.004738965349510283`", ",", "8.8236869796789`", ",", 
       "1.5279766257476195`", ",", "0.018466134036467758`", ",", 
       "39.68368520253024`", ",", "0.2323597806413694`", ",", 
       "0.04448548753782595`", ",", "0.24809009830166948`", ",", 
       "8.278078051889915`", ",", "0.0042655871122212995`", ",", 
       "5.359962118760654`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9479796304859169`", ",", "0.0648051218096276`", ",", "49163", ",", 
       "2184.37208166045`", ",", "2161.581027428025`", ",", 
       "5.576877135284149`", ",", "0.0005152871337384226`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.01644565466157307`", ",", "1.1851265833363094`", ",", 
       "0.05297979627858425`", ",", "0.05429835558034022`", ",", 
       "120.86006250472708`", ",", "0.0023273137638049183`", ",", 
       "21.43291075002426`", ",", "0.0012862302702856586`", ",", 
       "119.34658290442994`", ",", "121.77000229000696`", ",", 
       "0.0021402111119947537`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9474817779725958`", ",", "0.07548081191289957`", ",", "65957", ",", 
       "75.28471228985818`", ",", "2225.8941090704316`", ",", 
       "0.000060011926764739724`", ",", "1.0203057291344289`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.032683212515265424`", ",", "36.15959191874634`", ",", 
       "0.7983801369580218`", ",", "0.0016847849129702586`", ",", 
       "49.011639215963385`", ",", "0.05057835986348977`", ",", 
       "0.014457750623246763`", ",", "0.004508230083066135`", ",", 
       "9.174931224978854`", ",", "0.34314133494250143`", ",", 
       "0.0010014222988226833`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.947432994629299`", ",", "0.`", ",", "61082", ",", 
       "1130.7937381749825`", ",", "29120.760281103587`", ",", 
       "0.31182098796318336`", ",", "0.03739988088502454`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.006500929563330481`", ",", "0.16586744917815566`", ",", 
       "0.019737880586168755`", ",", "0.008969581774178887`", ",", 
       "29.86965540277324`", ",", "0.0016225274236899249`", ",", 
       "193.383411902936`", ",", "6.67944758042888`", ",", 
       "1.1946567893743716`", ",", "27.97243893424012`", ",", 
       "3.422156207917619`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9466437056951443`", ",", "0.07929246425591645`", ",", "24669", ",", 
       "28.55058310603157`", ",", "3330.286593315715`", ",", 
       "0.034539920020552034`", ",", "23.41462349943114`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.001211221150230446`", ",", "7.206329033039835`", ",", 
       "10.21758830981165`", ",", "0.0012865633726968516`", ",", 
       "138.9049017186285`", ",", "0.0010086834409078732`", ",", 
       "33.50456536168622`", ",", "0.7247788275835284`", ",", 
       "0.06010758975919648`", ",", "0.10030920169739072`", ",", 
       "0.06691812956804268`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.946559463106901`", ",", "0.08273309823227622`", ",", "85545", ",", 
       "14385.413712051199`", ",", "107966.62904439714`", ",", 
       "0.02163224085313285`", ",", "1.6688275490541256`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0031047922822037945`", ",", "8.554996372298755`", ",", 
       "2.3862888444724955`", ",", "0.07922714963136784`", ",", 
       "696.8259720563954`", ",", "0.018207068881035238`", ",", 
       "0.1866210357138387`", ",", "1.4895266723762832`", ",", 
       "0.36505688117736335`", ",", "0.01413163619361035`", ",", 
       "3.2432079581107858`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9463082334389771`", ",", "0.045759438196808964`", ",", "90312", ",",
        "3523.99910276931`", ",", "8795.522524381968`", ",", 
       "7.981558277601119`", ",", "0.03871077884639155`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0028410021614117143`", ",", "5.30295138584364`", ",", 
       "1.6876297079764038`", ",", "0.0025935567943782055`", ",", 
       "2.772533157393896`", ",", "0.011947350586606604`", ",", 
       "355.7893948933654`", ",", "5.569733268479994`", ",", 
       "342.31878589933984`", ",", "0.0902507323087995`", ",", 
       "8.588377818846816`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9461580064072542`", ",", "0.10692697375756753`", ",", "42393", ",", 
       "2460.6039336296644`", ",", "1073.6146260672383`", ",", 
       "0.015654579221365813`", ",", "0.00026364528044142476`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
      "0.002228960725058574`", ",", "0.04114255243668739`", ",", 
       "0.018616467882905156`", ",", "0.013386794878077162`", ",", 
       "0.006817626527737361`", ",", "27.21374142906044`", ",", 
       "77.66161162728369`", ",", "15.976244871248403`", ",", 
       "11.027575245074889`", ",", "0.001132074440999223`", ",", 
       "1.195130524201076`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.946042253433646`", ",", "0.046930765590486055`", ",", "21454", ",", 
       "26.81026168283973`", ",", "2033.3888211110066`", ",", 
       "0.20571611297383516`", ",", "0.0001026585097666713`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.05916926592768915`", ",", "726.4215290520065`", ",", 
       "8.510648408763648`", ",", "0.0528937738747802`", ",", 
       "2.515376660345834`", ",", "1.1080463183946518`", ",", 
       "0.0018941176577904977`", ",", "0.3977843555892241`", ",", 
       "31.165795863603407`", ",", "0.0075471859094240435`", ",", 
       "1.8878270258297327`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.9454572968690893`", ",", "0.`", ",", "16550", ",", 
       "12420.84325262598`", ",", "68.50377111148308`", ",", 
       "210.01037287897023`", ",", "0.00024216246369751566`"}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.645555731277239*^9, 3.645555839583878*^9}, 
   3.645556361304163*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ad10pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "29.771223516456974`", ",", "0.009858131475031371`", ",", 
       "2.0165667396519904`", ",", "111.11103801150924`", ",", 
       "8.04903091876997`", ",", "436.8445582345629`", ",", 
       "146.073447186022`", ",", "0.002688514490961823`", ",", 
       "48.0433323427348`", ",", "0.00798702899308538`", ",", 
       "0.8515754977830006`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.018296626381681017`", ",", "0.5814155095095006`", ",", "47351", ",",
        "0.06806656333781015`", ",", "4.004044936626813`", ",", 
       "0.000018405223829201803`", ",", "0.0001662463572698698`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "6.495173884982419`", ",", "0.303449160945173`", ",", 
       "2.046656949589212`", ",", "728.9460202285384`", ",", 
       "0.13788828124791352`", ",", "58.990866243804476`", ",", 
       "380.1939606367445`", ",", "0.023604723551786094`", ",", 
       "347.4762495743421`", ",", "0.00551541378465291`", ",", 
       "0.14247635323531338`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.03238542907456618`", ",", "0.4854917099011639`", ",", "51998", ",", 
       "0.36182343262096456`", ",", "0.08111540893866792`", ",", 
       "0.00006208600345006315`", ",", "0.000015872779194000405`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "160.03034406927426`", ",", "87.449301620148`", ",", 
       "1.318506106731833`", ",", "866.858044413187`", ",", 
       "0.011536227999241073`", ",", "16.521297742023936`", ",", 
       "639.4918808287775`", ",", "1.8181652293159396`", ",", 
       "76.58798936349945`", ",", "0.017880003482978923`", ",", 
       "0.3998064998389062`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.025065428099647298`", ",", "0.46351538620799426`", ",", "48218", 
       ",", "0.5546936004115185`", ",", "0.019072135370463053`", ",", 
       "0.0028431404429398047`", ",", "0.0002334570163229828`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
      "3.0662072436230936`", ",", "5.498405772437757`", ",", 
       "0.6086768762945097`", ",", "18.998039156800637`", ",", 
       "3.751166306974741`", ",", "559.6596611356331`", ",", 
       "0.541876013767302`", ",", "0.002099359953837825`", ",", 
       "81.4101093157353`", ",", "0.054497740559594506`", ",", 
       "0.4398280506368734`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.09711211272666409`", ",", "0.4579675973141543`", ",", "36849", ",", 
       "1.9917383801872481`", ",", "29.656262038018085`", ",", 
       "0.0038742441084305937`", ",", "0.0006694222746739507`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
      "0.6573680612693418`", ",", "0.007800154378741568`", ",", 
       "1.6271234967425947`", ",", "225.2042231180153`", ",", 
       "0.030894926755522547`", ",", "612.2981480907926`", ",", 
       "273.42300025485804`", ",", "0.02727566441882747`", ",", 
       "129.0641856939382`", ",", "0.00582289091565828`", ",", 
       "1.3239036432466929`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.004039786492959804`", ",", "0.44056198052763296`", ",", "60533", 
       ",", "2.487074969788444`", ",", "2.7189944954836176`", ",", 
       "0.00009975629114377276`", ",", "0.00004511624107300098`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "508.34809264098567`", ",", "1.07501256317539`", ",", 
       "23.00005723500125`", ",", "868.3941190448579`", ",", 
       "0.03813004807398619`", ",", "178.20277633292335`", ",", 
       "10.08774877886925`", ",", "0.0011649142342412995`", ",", 
       "116.29668746283134`", ",", "0.018354008107285328`", ",", 
       "0.2884080832637301`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.007489797193561068`", ",", "0.4345590934252392`", ",", "95160", ",",
        "0.047359417978930736`", ",", "0.20525347013754947`", ",", 
       "0.00011547811704841806`", ",", "0.0001578205579858094`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "346.692864980111`", ",", "373.61207555853986`", ",", 
       "2.0753728910430373`", ",", "131.7148437558505`", ",", 
       "22.227364740994528`", ",", "342.61719296531567`", ",", 
       "28.531155606642827`", ",", "0.16931067184335433`", ",", 
       "1.7151086972078036`", ",", "0.02898493747593818`", ",", 
       "3.525020930767023`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.21148852611534305`", ",", "0.42195317556847495`", ",", "86255", ",",
        "1.083631901311656`", ",", "2.7699577914133506`", ",", 
       "0.005934238142248056`", ",", "0.016899767066149013`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "412.2986853332481`", ",", "80.09761060536826`", ",", 
       "1.0315731741462781`", ",", "802.38178394562`", ",", 
       "0.23661674441727626`", ",", "12.886722481863494`", ",", 
       "825.2848270296176`", ",", "11.935485475998906`", ",", 
       "0.19649502945974812`", ",", "0.003966268830067967`", ",", 
       "1.395895209375592`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.07387365423513433`", ",", "0.4161590141963329`", ",", "79820", ",", 
       "0.19677284130542488`", ",", "0.01635548000821786`", ",", 
       "0.014462262100416111`", ",", "0.02018508478801218`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "26.707184999992954`", ",", "0.2258190821681327`", ",", 
       "5.088046043380533`", ",", "81.63471060393847`", ",", 
       "0.4202223795334992`", ",", "200.63390138595824`", ",", 
       "26.547387178742618`", ",", "0.0023912716615854895`", ",", 
       "2.875693639704387`", ",", "0.00299844231512822`", ",", 
       "5.597462358206743`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.030834632271693082`", ",", "0.39216932488414635`", ",", "3989", ",",
        "0.19896762333993892`", ",", "2.46285094021993`", ",", 
       "0.00009007559371041458`", ",", "0.0010426848930390413`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.4978242442556381`", ",", "0.007055631962913463`", ",", 
       "535.2274069283023`", ",", "531.0362033007426`", ",", 
       "15.75898938332753`", ",", "99.82584966809318`", ",", 
       "202.5768288834093`", ",", "0.0015021432656351697`", ",", 
       "346.32760348901377`", ",", "0.0011790525497715357`", ",", 
       "2.98006482166812`", ",", "0.0001`", ",", "0.1`", ",", "1", ",", 
       "0.002398863325044927`", ",", "0.39206569768232036`", ",", "62781", 
       ",", "1075.1474415645705`", ",", "0.2176590566386702`", ",", 
       "7.4151781026235265`*^-6", ",", "3.4044428971106763`*^-6"}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6455563788232813`*^9, 3.645556384693675*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorf", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", "altitude", "]"}], ",", "Cyan"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", "altitude", "]"}], ",", "Magenta"}], "}"}]}], 
       "}"}], ",", "#"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", "n_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"col", "[", "#1", "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", "#1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", ".5"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], "}"}], 
        "&"}], ",", 
       RowBox[{"Rescale", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"min", ",", "max"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", ".5"}]}], "]"}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"vars", "=", 
    RowBox[{"Array", "[", 
     RowBox[{"x", ",", "9"}], "]"}]}], ";", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"vars", ",", "k11"}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"dvars", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Derivative", "[", "1", "]"}], "[", "vars", "]"}], "]"}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"SeedRandom", "[", 
    RowBox[{"IntegerPart", "[", 
     RowBox[{"SessionTime", "[", "]"}], "]"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ts", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"totK", "=", "0.0001"}], ";", 
   RowBox[{"totP", "=", "0.1"}], ";", 
   RowBox[{"totS", "=", "1"}], ";", "\[IndentingNewLine]", 
   RowBox[{"stepNum", "=", "5"}], ";", "\[IndentingNewLine]", 
   RowBox[{"sampleSize", "=", "1000"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "iPar", ",", "num", ",", "usToAdPars", ",", "maxPars", 
       ",", "transPars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iPar", "=", "1"}], ",", 
        RowBox[{"iPar", "\[LessEqual]", "points"}], ",", 
        RowBox[{"iPar", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totT", "=", 
          RowBox[{
           RowBox[{"us10pars", "[", 
            RowBox[{"[", "iPar", "]"}], "]"}], "[", 
           RowBox[{"[", "11", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"usToAdPars", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"num", "=", "1"}], ",", 
           RowBox[{"num", "\[LessEqual]", "sampleSize"}], ",", 
           RowBox[{"num", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "ssthreshold", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"tot", "[", "n_", "]"}], ":=", 
                 RowBox[{
                  RowBox[{"tot", "[", "n", "]"}], "=", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"ksTest1", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"k", ",", "10"}], "]"}]}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", "1.*^-3"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", 
                 RowBox[{"1.", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "maxPars", "}"}], "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Array", "[", 
                   RowBox[{"k", ",", "10"}], "]"}], "\[Equal]", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "6"}], "-", "3"}], 
                    ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"us10pars", "[", 
                    RowBox[{"[", "iPar", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Range", "[", "4", "]"}], "+", "6"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "tPer", ",", "step", ",", "us", ",", "ad", ",", "x4", ",", 
                   "sol"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"step", "=", "0"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"tPer", "=", 
                   RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ssthreshold", "=", "1.*^-5"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"Print", "[", "des", "]"}], ";"}], " ", "*)"}], 
                  RowBox[{
                   RowBox[{"{", "sol", "}"}], "=", 
                   RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}], "\[Equal]", 
                    "des"}], ",", 
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"vars", "[", "0", "]"}], "]"}], "\[Equal]", 
                    "init"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"df", "=", 
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"WhenEvent", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", "df", "]"}], "<", "ssthreshold"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tPer", ",", "t"}], "]"}], ",", 
                    RowBox[{"step", "=", 
                    RowBox[{"step", "+", "1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step", ">", "stepNum"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"k11", "[", "t", "]"}], "\[Rule]", 
                    RowBox[{"10", "*", 
                    RowBox[{"k11", "[", "t", "]"}]}]}]}], "}"}]}], "]"}]}], 
                    "]"}]}], "}"}], "/.", "maxPars"}], ",", "vars", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "200000"}], "}"}], ",", 
                    RowBox[{"MaxSteps", "\[Rule]", "10000"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ts", "=", "tPer"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ts", "]"}], "==", 
                    RowBox[{"stepNum", "+", "1"}]}], " ", "&&", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"ts", ",", "Positive"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x4", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "/.", "sol"}], 
                    "]"}]}], ";", 
                    RowBox[{"xT", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "7", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "8", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "9", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}]}], ")"}], "/.", 
                    "sol"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    "totS"}], ")"}], "*", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"stepNum", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}]}], ")"}], "/", "2"}], ")"}], "/", 
                    "10.0"}], ",", "1.0"}], "]"}]}], ")"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "stepNum"}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ad", "=", 
                    RowBox[{"ad", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}], "/.", "sol"}], "]"}], "-", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", "sol"}], 
                    "]"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.2", "*", "totS"}], ")"}]}], ")"}], ",", 
                    "1.0"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "0.01", ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "totS"}], 
                    "]"}], ",", "0.01"}], "]"}], ")"}]}], ")"}]}], ")"}], 
                    "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ad", "/", "0.0001"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", "stepNum", ")"}]}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"usToAdPars", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"totT", ",", "us", ",", "ad", ",", "num"}], "}"}],
                     ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "[", "1", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "5", "]"}], ",", 
                    RowBox[{"k", "[", "6", "]"}], ",", 
                    RowBox[{"k", "[", "7", "]"}], ",", 
                    RowBox[{"k", "[", "8", "]"}], ",", 
                    RowBox[{"k", "[", "9", "]"}], ",", 
                    RowBox[{"k", "[", "10", "]"}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "2", "]"}], "+", 
                    RowBox[{"k", "[", "3", "]"}]}], 
                    RowBox[{"k", "[", "1", "]"}]], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "5", "]"}], "+", 
                    RowBox[{"k", "[", "6", "]"}]}], 
                    RowBox[{"k", "[", "4", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "8", "]"}], 
                    RowBox[{"k", "[", "7", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "10", "]"}], 
                    RowBox[{"k", "[", "9", "]"}]]}], "}"}], "/.", 
                    "maxPars"}]}], "]"}]}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transUsToAdPars", "=", 
          RowBox[{"Transpose", "[", "usToAdPars", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"usVsAd", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"altitude", "=", " ", 
          RowBox[{"Log10", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "*", 
             RowBox[{"transUsToAdPars", "[", 
              RowBox[{"[", "16", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vsPlot", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"colorf", "[", "#1", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                   RowBox[{"Point", "[", "#2", "]"}]}], "}"}]}], "}"}], "&"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"altitude", ",", "usVsAd"}], "}"}]}], "]"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "None"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"24", ",", 
               RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"leg", "=", 
          RowBox[{"plotLegend", "[", 
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", ",", "Max"}], "}"}], "[", "altitude", "]"}], 
             "]"}], ",", "10", ",", "colorf"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"legTxt", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)\[Sqrt](\!\(\*SubscriptBox[\(K\), \
\(M1\)]\)\[Times]\!\(\*SubscriptBox[\(K\), \(M2\)]\))\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}]}], "]"}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pLeg", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"vsPlot", ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "600"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"legTxt", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "50"}], "}"}]}]}], "]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"leg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<saturatedUsToAdSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.pdf\>\""}], 
           ",", "pLeg"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<saturatedUsToAdSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.eps\>\""}], 
           ",", "pLeg"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", "vsPlot", "]"}], "*)"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "points", ",", "iPar", ",", "num", ",", "adToUsPars", ",", "maxPars", 
       ",", "transPars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", "10"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iPar", "=", "1"}], ",", 
        RowBox[{"iPar", "\[LessEqual]", "points"}], ",", 
        RowBox[{"iPar", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totT", "=", 
          RowBox[{
           RowBox[{"ad10pars", "[", 
            RowBox[{"[", "iPar", "]"}], "]"}], "[", 
           RowBox[{"[", "11", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"adToUsPars", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"num", "=", "1"}], ",", 
           RowBox[{"num", "\[LessEqual]", "sampleSize"}], ",", 
           RowBox[{"num", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "ssthreshold", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"tot", "[", "n_", "]"}], ":=", 
                 RowBox[{
                  RowBox[{"tot", "[", "n", "]"}], "=", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"ksTest1", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"k", ",", "10"}], "]"}]}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", "1.*^-3"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"totT", "=", 
                 RowBox[{"1.", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "4"}], "-", "3"}], 
                    ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "maxPars", "}"}], "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Array", "[", 
                   RowBox[{"k", ",", "10"}], "]"}], "\[Equal]", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "6"}], "-", "3"}], 
                    ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ad10pars", "[", 
                    RowBox[{"[", "iPar", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Range", "[", "4", "]"}], "+", "6"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "tPer", ",", "step", ",", "us", ",", "ad", ",", "x4", ",", 
                   "sol"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"step", "=", "0"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"tPer", "=", 
                   RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"ssthreshold", "=", "1.*^-5"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"Print", "[", "des", "]"}], ";"}], " ", "*)"}], 
                  RowBox[{
                   RowBox[{"{", "sol", "}"}], "=", 
                   RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}], "\[Equal]", 
                    "des"}], ",", 
                    RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"vars", "[", "0", "]"}], "]"}], "\[Equal]", 
                    "init"}], ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"df", "=", 
                    RowBox[{"Through", "[", 
                    RowBox[{"dvars", "[", "t", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"WhenEvent", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", "df", "]"}], "<", "ssthreshold"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tPer", ",", "t"}], "]"}], ",", 
                    RowBox[{"step", "=", 
                    RowBox[{"step", "+", "1"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step", ">", "stepNum"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"k11", "[", "t", "]"}], "\[Rule]", 
                    RowBox[{"10", "*", 
                    RowBox[{"k11", "[", "t", "]"}]}]}]}], "}"}]}], "]"}]}], 
                    "]"}]}], "}"}], "/.", "maxPars"}], ",", "vars", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "200000"}], "}"}], ",", 
                    RowBox[{"MaxSteps", "\[Rule]", "10000"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ts", "=", "tPer"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "ts", "]"}], "==", 
                    RowBox[{"stepNum", "+", "1"}]}], " ", "&&", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"ts", ",", "Positive"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x4", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "/.", "sol"}], 
                    "]"}]}], ";", 
                    RowBox[{"xT", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "7", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "8", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"x", "[", "9", "]"}], "[", 
                    RowBox[{"ts", "-", "0.001"}], "]"}]}], ")"}], "/.", 
                    "sol"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"us", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    "totS"}], ")"}], "*", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "]"}], "/", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"stepNum", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "]"}], ",", 
                    "0.001"}], "]"}]}]}], ")"}], "/", "2"}], ")"}], "/", 
                    "10.0"}], ",", "1.0"}], "]"}]}], ")"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "\[LessEqual]", "stepNum"}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ad", "=", 
                    RowBox[{"ad", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}], "/.", "sol"}], "]"}], "-", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "4", "]"}], "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", "sol"}], 
                    "]"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"0.2", "*", "totS"}], ")"}]}], ")"}], ",", 
                    "1.0"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", "0.01", ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x4", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "totS"}], 
                    "]"}], ",", "0.01"}], "]"}], ")"}]}], ")"}]}], ")"}], 
                    "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ad", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ad", "/", "0.0001"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", "stepNum", ")"}]}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"adToUsPars", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"totT", ",", "us", ",", "ad", ",", "num"}], "}"}],
                     ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "[", "1", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "5", "]"}], ",", 
                    RowBox[{"k", "[", "6", "]"}], ",", 
                    RowBox[{"k", "[", "7", "]"}], ",", 
                    RowBox[{"k", "[", "8", "]"}], ",", 
                    RowBox[{"k", "[", "9", "]"}], ",", 
                    RowBox[{"k", "[", "10", "]"}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "2", "]"}], "+", 
                    RowBox[{"k", "[", "3", "]"}]}], 
                    RowBox[{"k", "[", "1", "]"}]], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"k", "[", "5", "]"}], "+", 
                    RowBox[{"k", "[", "6", "]"}]}], 
                    RowBox[{"k", "[", "4", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "8", "]"}], 
                    RowBox[{"k", "[", "7", "]"}]], ",", 
                    FractionBox[
                    RowBox[{"k", "[", "10", "]"}], 
                    RowBox[{"k", "[", "9", "]"}]]}], "}"}], "/.", 
                    "maxPars"}]}], "]"}]}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transAdToUsPars", "=", 
          RowBox[{"Transpose", "[", "adToUsPars", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"usVsAd", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"altitude", "=", " ", 
          RowBox[{"Log10", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "15", "]"}], "]"}], "*", 
             RowBox[{"transAdToUsPars", "[", 
              RowBox[{"[", "16", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vsPlot", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"colorf", "[", "#1", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                   RowBox[{"Point", "[", "#2", "]"}]}], "}"}]}], "}"}], "&"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"altitude", ",", "usVsAd"}], "}"}]}], "]"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "None"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"24", ",", 
               RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"leg", "=", 
          RowBox[{"plotLegend", "[", 
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", ",", "Max"}], "}"}], "[", "altitude", "]"}], 
             "]"}], ",", "10", ",", "colorf"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"legTxt", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)\[Sqrt](\!\(\*SubscriptBox[\(K\), \
\(M1\)]\)\[Times]\!\(\*SubscriptBox[\(K\), \(M2\)]\))\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}]}], "]"}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pLeg", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"vsPlot", ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "600"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"legTxt", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "50"}], "}"}]}]}], "]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Show", "[", 
                   RowBox[{"leg", ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<saturatedAdToUsSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.pdf\>\""}], 
           ",", "pLeg"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<saturatedAdToUsSampleK1K2ColourLegend\>\"", "<>", 
            RowBox[{"ToString", "[", "iPar", "]"}], "<>", "\"\<.eps\>\""}], 
           ",", "pLeg"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", "vsPlot", "]"}], "*)"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.64587672793963*^9, 3.6458767330744553`*^9}, {
   3.6458767662948933`*^9, 3.645876806455565*^9}, {3.645876900230595*^9, 
   3.645877005387528*^9}, {3.6458770624098043`*^9, 3.6458771862736187`*^9}, 
   3.64589983282318*^9, 3.64612514992883*^9, {3.646125187014167*^9, 
   3.64612535002877*^9}, 3.646125396316476*^9, {3.646125430335791*^9, 
   3.646125492519535*^9}, {3.646128900513362*^9, 3.6461289084943237`*^9}, {
   3.646131869390991*^9, 3.6461319855403767`*^9}, 3.646132237248633*^9, {
   3.646137856699683*^9, 3.6461378610228148`*^9}, {3.646137967197999*^9, 
   3.646137988429431*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "evcvmit"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Event location failed to converge to the requested \
accuracy or precision within \[NoBreak]\\!\\(100\\)\[NoBreak] iterations \
between \[NoBreak]\\!\\(t\\)\[NoBreak] = \
\[NoBreak]\\!\\(162.23713568186588`\\)\[NoBreak] and \[NoBreak]\\!\\(t\\)\
\[NoBreak] = \[NoBreak]\\!\\(162.54079056180865`\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NDSolve\\\", ButtonNote -> \
\\\"NDSolve::evcvmit\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6461375675979652`*^9, 3.64613790501993*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "evcvmit"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Event location failed to converge to the requested \
accuracy or precision within \[NoBreak]\\!\\(100\\)\[NoBreak] iterations \
between \[NoBreak]\\!\\(t\\)\[NoBreak] = \[NoBreak]\\!\\(39.7910070239499`\\)\
\[NoBreak] and \[NoBreak]\\!\\(t\\)\[NoBreak] = \
\[NoBreak]\\!\\(40.14246761230065`\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/NDSolve\\\", ButtonNote -> \
\\\"NDSolve::evcvmit\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6461375675979652`*^9, 3.646137909689678*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "evcvmit"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Event location failed to converge to the requested \
accuracy or precision within \[NoBreak]\\!\\(100\\)\[NoBreak] iterations \
between \[NoBreak]\\!\\(t\\)\[NoBreak] = \
\[NoBreak]\\!\\(798.2393430481955`\\)\[NoBreak] and \[NoBreak]\\!\\(t\\)\
\[NoBreak] = \[NoBreak]\\!\\(798.5418055645977`\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NDSolve\\\", ButtonNote -> \
\\\"NDSolve::evcvmit\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6461375675979652`*^9, 3.646137916421729*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(NDSolve \
:: evcvmit\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6461375675979652`*^9, 3.646137916451933*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.64613107449291*^9, 3.646137849347657*^9, 
  3.646137918120071*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1127, 965},
WindowMargins->{{38, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 232, 3, 92, "Title"],
Cell[815, 27, 7556, 210, 267, "Input"],
Cell[8374, 239, 6684, 118, 692, "Input"],
Cell[15061, 359, 6719, 121, 692, "Input"],
Cell[21783, 482, 2406, 70, 114, "Input"],
Cell[CellGroupData[{
Cell[24214, 556, 43777, 995, 2726, "Input"],
Cell[67994, 1553, 704, 13, 24, "Message"],
Cell[68701, 1568, 702, 13, 24, "Message"],
Cell[69406, 1583, 703, 13, 24, "Message"],
Cell[70112, 1598, 557, 11, 24, "Message"],
Cell[70672, 1611, 123, 2, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
